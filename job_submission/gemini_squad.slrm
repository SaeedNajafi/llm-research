#!/bin/bash
#SBATCH --job-name=qa-inference
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=1
#SBATCH --cpus-per-gpu=4
#SBATCH --mem=8G
#SBATCH --gres=gpu:1
#SBATCH --output=qa-inference-squad-jupyter.%j.out
#SBATCH --error=qa-inference-squad-jupyter.%j.err
#SBATCH --partition=t4v2
#SBATCH --qos=long
#SBATCH --open-mode=append
#SBATCH --wait-all-nodes=1
#SBATCH --time=48:00:00

date;hostname;pwd

OUTPUT_FILE=$1

module load python/3.10.12 cuda-11.8
source ${PWD}/llm-env/bin/activate
export PATH=${PWD}/llm-env/bin:$PATH
export CUDA_HOME=/pkgs/cuda-11.8
export TRITON_PTXAS_PATH=/pkgs/cuda-11.8/bin/ptxas
export XDG_RUNTIME_DIR=""

python3 notebooks/gemini_qa_squad.py --output_file=${OUTPUT_FILE}